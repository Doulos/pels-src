/* buferr-overflow1.c
 */
#include<stdio.h>
#include<string.h> 
#include<unistd.h>

#define BUFFER_SIZE 64
#define PASSWORD "password"

void unsafe (char *input);
void caller (char *input);

void secret() {
	printf("WE TRUST YOU - NOBODY GETS THIS FAR WITHOUT THE PASSWORD!!!\n");
}

void caller (char *input) {
	unsafe (input);
}

void unsafe (char *input)
{
	// strcmp returns 0 onlyh if the stgrings match:
	if ( ! strcmp(PASSWORD,input) ) {// buggy authentication...
		secret();
	} else
		printf("Got string %s which is not correct :( \n", input );
}

int main(int argc,char **argv)
{

	if(argc != 2)
	{
		printf("Usage : %s userInput\n",argv[0]);
		return(0);
	}


//	unsafe(argv[1]); 
	caller(argv[1]);
	
	return 0;
}

